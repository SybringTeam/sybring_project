@model sybring_project.Models.Db.Project

@{
    var error = TempData["ErrorMessage"];
    var added = TempData["Added"];
}

<h1>Project Details</h1>

<div>
    <h4>Project Information</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Id)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Id)
        </dd>

        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Name)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Name)
        </dd>


        <dd class="col-sm-10">
            @if (Model.ProjectHistories == null || !Model.ProjectHistories.Any())
            {
                <p>New user has no time to show.</p>

            }
            else
            {
                @for (int i = 0; i < 7; i++)
                {
                    var currentDayOfWeek = (DayOfWeek)(((int)DayOfWeek.Monday + i) % 7);
                    var projectTimeReportsForDay = Model.ProjectHistories.Where(ptr => ptr.ProjectHours > TimeSpan.Zero && ptr.TimeHistory.Date.DayOfWeek == currentDayOfWeek).ToList();

                    <div>
                        <h4>@currentDayOfWeek</h4>
                        @if (projectTimeReportsForDay.Any())
                        {
                            foreach (var projectTimeReport in projectTimeReportsForDay)
                            {
                                <div>
                                    <p>User: @Html.DisplayFor(modelItem => projectTimeReport.TimeHistory.Users)</p>
                                    <p>Project: @Html.DisplayFor(modelItem => projectTimeReport.ProjectId)</p>
                                    <!-- Display other project time report properties as needed -->
                                </div>
                            }
                        }
                        else
                        {
                            <p>No time reports for @currentDayOfWeek.</p>
                        }
                    </div>
                }
            }
        </dd>
    </dl>
</div>
<div>
    <h4>Assign a User</h4>
    <form asp-controller="Project" asp-action="Details" method="post">
        <div class="form-group">
            <label asp-for="Users">Select User:</label>
            <select asp-for="Users" asp-items="@(new SelectList(ViewBag.AllUsers, "Id", "UserName"))" class="form-control">
                <option value="">Select a User</option>
            </select>
            <span asp-validation-for="Users" class="text-danger"></span>
        </div>

        <input type="hidden" asp-for="Users" />

        <button type="submit" class="btn btn-primary">Assign a User</button>
    </form>
</div>


</div>


    @if (error != null)
    {
        <div>@error<br /></div>
    }
    else

    {
        <div>@added</div>
    }



<div>
    <a asp-action="Index">Back to List</a>
</div>
